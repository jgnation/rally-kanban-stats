<!DOCTYPE html>
<html>
<head>
    <title>exclusions</title>

    <script type="text/javascript" src="https://rally1.rallydev.com/apps/2.0rc3/sdk.js"></script>

    <script type="text/javascript">
        Rally.onReady(function () {
                Ext.Loader.setConfig({enabled:!0,disableCaching:!0,paths:{"Ext.ux":"ux"}}),Ext.require(["Ext.ux.form.field.MultiDate"]),Ext.define("CustomApp",{extend:"Rally.app.App",componentCls:"app",items:{html:'<a href="https://help.rallydev.com/apps/2.0rc3/doc/">App SDK 2.0rc3 Docs</a>'},launch:function(){this.excludedDates=[],console.log("Our First App woot!"),this._createDateFields(),this._addMultiDateCalendar(),this._createButtons()},_createButtons:function(){var getReportButton=Ext.create("Ext.Container",{items:[{xtype:"rallybutton",text:"Get Report",listeners:{click:function(myStore,myData,success){var sDate=Rally.util.DateTime.toIsoString(this.startDate),eDate=Rally.util.DateTime.toIsoString(this.endDate);this._loadData(sDate,eDate)},scope:this}}],renderTo:Ext.getBody().dom,scope:this});this.add(getReportButton)},_createDateFields:function(){var start=Ext.create("Ext.Container",{items:[{xtype:"rallydatefield",fieldLabel:"Start Date",value:this.startDate=new Date,listeners:{change:function(start,newValue,oldValue,eOpts){this.startDate=newValue},scope:this}}],renderTo:Ext.getBody().dom}),end=Ext.create("Ext.Container",{items:[{xtype:"rallydatefield",fieldLabel:"End Date",value:this.endDate=new Date,listeners:{change:function(start,newValue,oldValue,eOpts){this.endDate=newValue},scope:this}}],renderTo:Ext.getBody().dom});this.add(start),this.add(end)},_loadData:function(startDate,endDate){var myStore=Ext.create("Rally.data.wsapi.Store",{model:"User Story",autoLoad:!0,filters:[{property:"ScheduleState",operation:"=",value:"Accepted"},{property:"DirectChildrenCount",operation:"=",value:"0"},{property:"InProgressDate",operator:">=",value:startDate},{property:"AcceptedDate",operator:"<=",value:endDate}],listeners:{load:function(myStore,myData,success){console.log("got data!",myStore,myData,success);var a=this.excludedDates,records=_.map(myData,function(record){function calculateDateDifference(record){var inProgressDate=record.get("InProgressDate"),acceptedDate=record.get("AcceptedDate"),oneDay=864e5,diffDays=Math.ceil(Math.abs((inProgressDate.getTime()-acceptedDate.getTime())/oneDay));return diffDays}function calculateExclusions(record,excludedDates){var field=Ext.getCmp("multiDateField"),inProgressDate=record.get("InProgressDate"),acceptedDate=record.get("AcceptedDate"),inProgressDateString=inProgressDate.getFullYear()+"-"+("0"+(inProgressDate.getMonth()+1)).slice(-2)+"-"+("0"+inProgressDate.getDate()).slice(-2),acceptedDateString=acceptedDate.getFullYear()+"-"+("0"+(acceptedDate.getMonth()+1)).slice(-2)+"-"+("0"+acceptedDate.getDate()).slice(-2),dateRange=inProgressDateString+"/"+acceptedDateString,dateArray=field.expandValues(dateRange,"Y-m-d",";","/"),dateStringArray=_.map(dateArray,function(date){return""+date}),intersection=_.intersection(dateStringArray,excludedDates),exclusions=calculateDateDifference(record)-intersection.length;return exclusions>=0?exclusions:0}return Ext.apply({DaysInProgress:calculateDateDifference(record,this),DaysInProgressExclusions:calculateExclusions(record,this.excludedDates)},record.getData())},this);this._loadGrid(myStore,records)},scope:this},fetch:["FormattedID","Name","AcceptedDate","InProgressDate","RevisionHistory","Revisions","Description","User","Project"]})},_loadGrid:function(myStoryStore,records){var myGrid=Ext.create("Rally.ui.grid.Grid",{store:Ext.create("Rally.data.custom.Store",{data:records}),columnCfgs:[{text:"FormattedID",dataIndex:"FormattedID"},{text:"Name",dataIndex:"Name"},{text:"InProgressDate",dataIndex:"InProgressDate"},{text:"AcceptedDate",dataIndex:"AcceptedDate"},{text:"DaysInProgress",dataIndex:"DaysInProgress"},{text:"DaysInProgress (Exclusions)",dataIndex:"DaysInProgressExclusions"},{text:"Project",dataIndex:"Project"}]});this.add(myGrid),console.log("what is this?",this)},_addMultiDateCalendar:function(){console.log("blah"),Ext.tip.QuickTipManager.init();var store,panel;panel=Ext.create("Ext.form.Panel",{width:200,height:200,id:"formPanel",layout:"vbox",defaults:{autoScroll:!0,bodyPadding:8,listeners:{specialkey:function(form,event){event.getKey()===event.ENTER&&form.up().down("#validateButton").handler()}}},position:"absolute",x:20,y:20,items:[{xtype:"multidatefield",id:"multiDateField",allowBlank:!1,multiValue:!0,submitFormat:"Y-m-d",submitRangeSeparator:"/"},{xtype:"button",id:"validateButton",text:"Validate",scope:this,handler:function(){var form,field;if(form=Ext.getCmp("formPanel").getForm(),field=Ext.getCmp("multiDateField"),form.isValid()){var values=form.getValues(),valuesString=field.getSubmitValue(),valuesArray=field.expandValues(valuesString,"Y-m-d",";","/");this.excludedDates=_.map(valuesArray,function(date){return""+date}),alert("Form is valid: "+Ext.JSON.encode(values[field.inputId]))}else alert("Form is invalid")}}],renderTo:Ext.getBody()}),this.add(panel)}});
                Ext.define("Ext.ux.form.field.MultiDate",{extend:"Ext.form.field.Date",alias:"widget.multidatefield",alternateClassName:["Ext.form.field.MultiDate","Ext.form.MultiDateField","Ext.form.MultiDate"],requires:["Ext.ux.picker.MultiDate"],mixins:{multivalue:"Ext.ux.form.field.MultiValue"},okText:"OK",cancelText:"Cancel",clearText:"Clear",multiDisabledText:"Multiple dates are not allowed",invalidRangeText:"{0} is not a valid date range",invalidRangeEndsText:"{0} is invalid: start date must be earlier than end date",workDays:[1,2,3,4,5],altFormats:"m/d/Y|n/j/Y|n/j/y|m/j/y|n/d/y|m/j/Y|n/d/Y|m/d|n/j",initComponent:function(){var me=this;me.callParent(arguments),me.multiValue&&(me.showToday=!1)},initValue:function(){var me=this,value=me.value;if(value&&Ext.isString(value))me.setRawValue(value);else{if(!Ext.isDate(value))return;me.setRawValue(me.formatDisplayValue(value))}me.validate()},setValue:function(value,isSubmit){var me=this;isSubmit?me.setSubmitValue(value):me.callParent([value])},setSubmitValue:function(value){var me=this,fmt=me.submitFormat,vsep,rsep,values,collapsed,text;vsep=new XRegExp(me.submitValueSeparator),rsep=new XRegExp(me.submitRangeSeparator),values=me.expandValues(value,fmt,vsep,rsep),values&&values.length?(collapsed=me.collapseRange(values),text=me.formatDisplay(collapsed),me.setRawValue(text)):me.setRawValue("")},getSubmitValue:function(){var me=this,values;return values=me.getRawValue(),me.formatSubmit(values)},createPicker:function(){var me=this,format=Ext.String.format;return me.multiValue?Ext.create("Ext.picker.MultiDate",{pickerField:me,ownerCt:me.ownerCt,renderTo:document.body,floating:!0,hidden:!0,focusOnShow:!0,minDate:me.minValue,maxDate:me.maxValue,disabledDatesRE:me.disabledDatesRE,disabledDatesText:me.disabledDatesText,disabledDays:me.disabledDays,disabledDaysText:me.disabledDaysText,format:me.format,showToday:me.showToday,startDay:me.startDay,okText:me.okText,cancelText:me.cancelText,clearText:me.clearText,workDays:Ext.Array.sort(me.workDays,function(a,b){return a-b}),minText:format(me.minText,me.formatDate(me.minValue)),maxText:format(me.maxText,me.formatDate(me.maxValue)),listeners:{scope:me,select:me.onSelect}}):me.callParent(arguments)},getErrors:function(values){var me=this,multi=me.multiValue,vsep=me.valueSeparatorRE,rsep=me.rangeSeparatorRE,errors=[],matches,range,isValid,dt;if(null===values||1>values.length)return me.allowBlank||errors.push(me.blankText),errors;matches=me.splitValues(values,vsep),!multi&&matches.length>1&&errors.push(me.multiDisabledText);for(var i=0,l=matches.length;l>i;i++){var match=matches[i];dt=me.parseDate(match),Ext.isDate(dt)?isValid=me.validateDate(match):rsep.test(match)?(range=me.splitValues(match,rsep),!multi&&range.length>1&&errors.push(me.multiDisabledText),isValid=me.validateRange(range)):isValid=Ext.String.format(me.invalidText,match,me.format),isValid!==!0&&errors.push(isValid)}return errors},splitValues:function(values,regex){var me=this;return Ext.isString(values)&&""!==regex.source&&values.match(regex)?values.split(regex):[values]},onExpand:function(){var me=this,text,values;return me.multiValue?(text=me.getRawValue(),me.isValid()?(values=me.expandValues(text),me.picker.setValue(values)):""===text&&me.clearInvalid(),void 0):me.callParent(arguments)},onSelect:function(picker,dates){var me=this,collapsed,text;return me.multiValue?(collapsed=me.collapseRange(dates),text=me.formatDisplay(collapsed),me.setRawValue(text),me.fireEvent("select",me,text),me.collapse(),void 0):me.callParent(arguments)},parseDate:function(value,format){var me=this,dt;return format&&(dt=me.safeParse(value,format))?dt:me.callParent([value])},validateDate:function(value){var me=this,dt;return dt=me.parseDate(value),Ext.isDate(dt)||Ext.String.format(me.invalidText,value,me.format)},validateRange:function(range){var me=this,rsep=me.displayRangeSeparator,isDate=Ext.isDate,getElapsed=Ext.Date.getElapsed,format=Ext.String.format,start,end,isValid=!1;try{start=me.parseDate(range[0]),end=me.parseDate(range[1]),isValid=!!(isDate(start)&&isDate(end)&&start.getTime()<=end.getTime())}catch(e){}return isDate(start)&&isDate(end)?start.getTime()>end.getTime()?format(me.invalidRangeEndsText,me.formatDisplayRange(range,rsep)):(isValid=me.validateDate(range[0]))!==!0?isValid:(isValid=me.validateDate(range[1]))!==!0?isValid:!0:format(me.invalidRangeText,range[0]+rsep+range[1])},formatSubmit:function(values,rsep,vsep){var me=this,multi=me.multiValue,valsep=me.valueSeparatorRE,ransep=me.rangeSeparatorRE,items,isStr,doesMatch,dt;items=me.splitValues(values,valsep);for(var i=0,l=items.length;l>i;i++){var item=items[i],vr;Ext.isDate(me.parseDate(item))?items[i]=me.formatSubmitValue(item):(vr=me.splitValues(item,ransep),items[i]=vr.length>1?me.formatSubmitRange(vr,rsep||me.submitRangeSeparator):me.formatSubmitValue(vr))}return values=items.join(vsep||me.submitValueSeparator)},formatSubmitValue:function(value){var me=this,fmt=me.submitFormat||me.format,dt,res;try{dt=Ext.Date.clearTime(me.parseDate(value)),res=Ext.Date.format(dt,fmt)}catch(e){}return Ext.isString(res)?res:""},formatDisplayValue:function(value){var me=this,fmt=me.format,dt,res;try{res=Ext.Date.format(value,fmt)}catch(e){}return Ext.isString(res)?res:""},expandValues:function(text,format,vSeparator,rSeparator){var me=this,vsep=vSeparator||me.valueSeparatorRE,rsep=rSeparator||me.rangeSeparatorRE,values,dt,result=[];if(""===text||null===text)return[];values=me.splitValues(text,vsep);for(var i=0,l=values.length;l>i;i++){var value=values[i];if(dt=me.parseDate(value,format),Ext.isDate(dt))result.push(dt);else{var range=me.splitValues(value,rsep);result=[].concat(result,range.length>1?me.expandRange(range,format):me.parseDate(range[0]))}}return result},expandRange:function(range,format){var me=this,start,end,result=[];if(start=me.parseDate(range[0],format),end=me.parseDate(range[1],format),!Ext.isDate(start)||!Ext.isDate(end)||0>Ext.Date.getElapsed(start,end))return[];dt=start;for(var dt=start;end>=dt;dt=Ext.Date.add(dt,Ext.Date.DAY,1))result.push(dt);return result},collapseRange:function(data){var me=this,range=Ext.clone(data),first,last,result=[];if(Ext.isEmpty(data))return result;range.sort(function(a,b){return a.getTime()-b.getTime()});for(var i=0,l=range.length;l>i;i++){var item=range[i];void 0!==first?me.nextInRange(last,item)?last=item:me.equalValues(first,last)?(result.push(first),first=last=item):(result.push([first,last]),first=last=item):first=last=item}return me.equalValues(first,last)?result.push(first):result.push([first,last]),result},nextInRange:function(first,last){var dt;return dt=Ext.Date.add(first,Ext.Date.DAY,1),!(dt.getTime()!==last.getTime())},equalValues:function(first,last){return first.getTime()===last.getTime()}});
                Ext.define("Ext.ux.form.field.MultiMonth",{extend:"Ext.ux.form.field.MultiDate",alias:"widget.multimonthfield",alternateClassName:["Ext.form.field.MultiMonth","Ext.form.MultiMonthField","Ext.form.MultiMonth"],requires:["Ext.picker.Month","Ext.ux.picker.MultiMonth"],startingMonthText:"Starting Month",endingMonthText:"Ending Month",valueSeparatorRE:/^$/,format:"m/Y",altFormats:"m/y|n/Y|n/y|m|n",createPicker:function(){var me=this,format=Ext.String.format;return me.multiValue?Ext.create("Ext.picker.MultiMonth",{pickerField:me,ownerCt:me.ownerCt,renderTo:document.body,floating:!0,hidden:!0,small:!1,focusOnShow:!0,minDate:me.minValue,maxDate:me.maxValue,format:me.format,startingMonthText:me.startingMonthText,endingMonthText:me.endingMonthText,okText:me.okText,cancelText:me.cancelText,clearText:me.clearText,minText:format(me.minText,me.formatDate(me.minValue)),maxText:format(me.maxText,me.formatDate(me.maxValue)),listeners:{scope:me,cancelclick:me.onCancelClick,okclick:me.onOkClick},keyNavConfig:{esc:function(){me.collapse()}}}):Ext.create("Ext.picker.Month",{pickerField:me,ownerCt:me.ownerCt,renderTo:document.body,floating:!0,hidden:!0,small:!1,focusOnShow:!0,minDate:me.minValue,maxDate:me.maxValue,format:me.format,minText:format(me.minText,me.formatDate(me.minValue)),maxText:format(me.maxText,me.formatDate(me.maxValue)),listeners:{scope:me,cancelclick:me.onCancelClick,okclick:me.onOkClick,yeardblclick:me.onOkClick,monthdblclick:me.onOkClick},keyNavConfig:{esc:function(){me.collapse()}}})},getErrors:function(values){var me=this,multi=me.multiValue,rsep=me.rangeSeparatorRE,format=Ext.String.format,errors,range,dt,isValid;return errors=me.callParent(arguments)||[],errors.length?errors:(multi&&""!==values&&(dt=me.parseDate(values),Ext.isDate(dt)?(isValid=me.validateDate(values),isValid!==!0&&errors.push(isValid)):(range=me.splitValues(values,rsep),2>range.length&&errors.push(format(me.invalidRangeText,values)))),errors)},setSubmitValue:function(value){var me=this,fmt=me.submitFormat,vsep,rsep,values,text;vsep=new XRegExp(me.submitValueSeparator),rsep=new XRegExp(me.submitRangeSeparator),values=me.splitValues(value,rsep),text=me.multiValue?me.formatDisplay(values,void 0,void 0,fmt):me.formatDisplayValue(values[0],fmt),me.setRawValue(text||"")},onCancelClick:function(){var me=this;me.collapse()},onOkClick:function(){var me=this,picker=me.picker,values,text;me.multiValue?(values=Ext.Array.map(picker.getValue(),me.formatPickerValue,me),text=me.formatDisplay(values)):(values=me.formatPickerValue(picker.getValue()),text=me.formatDisplayValue(values)),me.setRawValue(text),me.fireEvent("select",me,text),me.collapse(),me.validate()},formatPickerValue:function(value){var me=this,dt;return dt=Ext.Date.parse(value[1]+"-"+(value[0]+1)+"-1","Y-n-j"),Ext.Date.format(dt,me.format)},formatSubmitValue:function(value){var me=this,fmt=me.submitFormat||me.format,dt,res;try{dt=Ext.Date.clearTime(me.parseDate(value)),dt.setDate(1),res=Ext.Date.format(dt,fmt)}catch(e){}return Ext.isString(res)?res:""},formatDisplayValue:function(value,format){var me=this,fmt=me.format,dt,res;try{dt=Ext.Date.clearTime(me.parseDate(value,format)),res=Ext.Date.format(dt,fmt)}catch(e){}return Ext.isString(res)?res:value},formatDisplay:function(values,rsep,vsep,format){var me=this,start,end;return me.multiValue?(start=me.formatDisplayValue(values[0],format),end=me.formatDisplayValue(values[1],format),start&&end?start+(rsep||me.displayRangeSeparator)+end:""):values},expandValues:function(text,format,vSeparator,rSeparator){var me=this,rsep=rSeparator||me.rangeSeparatorRE,fmt=format||me.format,values,result;if(""===text||null===text){var now=new Date;return[[now.getMonth(),now.getFullYear()],[now.getMonth(),now.getFullYear()]]}return values=me.splitValues(text,rsep),result=Ext.Array.map(values,function(value){var dt=me.parseDate(value,fmt);return[dt.getMonth(),dt.getFullYear()]},me)}});
                Ext.define("Ext.ux.form.field.MultiTime",{extend:"Ext.ux.form.field.MultiMonth",alias:"widget.multitimefield",alternateClassName:["Ext.form.field.MultiTime","Ext.form.MultiTimeField","Ext.form.MultiTime"],requires:["Ext.ux.picker.MultiTime"],minText:"{0} is less than minimum time",maxText:"{0} is more than maximum time",invalidRangeText:"{0} is not a valid time range",invalidRangeEndsText:"{0} is invalid: start time must be less than end time",selectTimeText:"Select Time",startingTimeText:"Starting Time",endingTimeText:"Ending Time",amText:"AM",pmText:"PM",hoursText:"Hours:",minutesText:"Minutes:",okText:"OK",cancelText:"Cancel",clearText:"Clear",hourValues:["12","1","2","3","4","5","6","7","8","9","10","11"],minuteValues:["00","15","30","45"],format:"g:i A",submitFormat:"H:i",altFormats:"g:ia|g:iA|g:i a|g:i A|h:i|g:i|H:i|ga|ha|gA|h a|g a|g A|gi|hi|gia|hia|g|H|gi a|hi a|giA|hiA|gi A|hi A",increment:15,invalidIncrementText:"Time should be entered in {0} minutes increments",triggerCls:"ux-form-time-trigger",valueSeparatorRE:/^$/,submitRangeSeparator:"/",createPicker:function(){var me=this;return Ext.create("Ext.ux.picker.MultiTime",{pickerField:me,ownerCt:me.ownerCt,renderTo:document.body,floating:!0,hidden:!0,focusOnShow:!0,minTime:me.getMinTime(),maxTime:me.getMaxTime(),multiValue:me.multiValue,startingTimeText:me.startingTimeText,endingTimeText:me.endingTimeText,amText:me.amText,pmText:me.pmText,hoursText:me.hoursText,minutesText:me.minutesText,okText:me.okText,cancelText:me.cancelText,clearText:me.clearText,hourValues:me.hourValues,minuteValues:me.minuteValues,increment:me.increment,listeners:{scope:me,okclick:me.onOkClick,cancelclick:me.onCancelClick},keyNavConfig:{esc:function(){me.collapse()}}})},onExpand:function(){var me=this,text,values;return me.multiValue?me.callParent():(text=me.getRawValue(),me.isValid()?(values=me.expandValues(text),me.picker.setValue(values)):""===text&&me.clearInvalid(),void 0)},getMinTime:function(){var me=this,dt;try{dt=new Date(me.minValue)}catch(e){}return Ext.isDate(dt)&&!isNaN(dt.getTime())?3600*dt.getHours()+60*dt.getMinutes():-1/0},getMaxTime:function(){var me=this,dt;try{dt=new Date(me.maxValue)}catch(e){}return Ext.isDate(dt)&&!isNaN(dt.getTime())?3600*dt.getHours()+60*dt.getMinutes():+1/0},validateRange:function(range){var me=this,rsep=me.displayRangeSeparator,format=Ext.String.format,start,end,isValid;return isValid=me.callParent(arguments),isValid!==!0?isValid:(start=me.parseDate(range[0]),end=me.parseDate(range[1]),3600*start.getHours()+60*start.getMinutes()<me.getMinTime()?format(me.minText,range[0]):3600*end.getHours()+60*end.getMinutes()>me.getMaxTime()?format(me.maxText,range[1]):0!==start.getMinutes()%me.increment||0!==end.getMinutes()%me.increment?format(me.invalidIncrementText,me.increment):!0)},validateDate:function(value){var me=this,isDate=Ext.isDate,format=Ext.String.format,dt;try{dt=me.parseDate(value)}catch(e){}return isDate(dt)?3600*dt.getHours()+60*dt.getMinutes()<me.getMinTime()?format(me.minText,value):3600*dt.getHours()+60*dt.getMinutes()>me.getMaxTime()?format(me.maxText,value):0!==dt.getMinutes()%me.increment?format(me.invalidIncrementText,me.increment):!0:format(me.invalidText,value,me.format)},formatSubmitValue:function(value){var me=this,fmt=me.submitFormat||me.format,dt,res;try{dt=me.parseDate(value),res=Ext.Date.format(dt,fmt)}catch(e){}return Ext.isString(res)?res:""},formatDisplayValue:function(value){var me=this,fmt=me.format,dt,res;try{dt=me.parseDate(value),res=Ext.Date.format(dt,fmt)}catch(e){}return Ext.isString(res)?res:value},formatPickerValue:function(value){var me=this,hourValues=me.hourValues,minuteValues=me.minuteValues,indexOf=Ext.Array.indexOf,hours,minutes,dt;if(null===value[0]||null===value[1]||null===value[2])return"";try{hours=12*value[0]+indexOf(hourValues,value[1]),minutes=15*indexOf(minuteValues,value[2]),dt=new Date,dt.setHours(hours,minutes,0,0)}catch(e){return}return Ext.Date.format(dt,me.format)},expandValues:function(text){var me=this,rsep=me.rangeSeparatorRE,increment=me.increment,hourValues=me.hourValues,minuteValues=me.minuteValues,fmt=me.format,mfloor=Math.floor,values,times,result;return""===text||null===text?[[null,null,null],[null,null,null]]:(values=me.splitValues(text,rsep),times=Ext.Array.map(values,Ext.bind(me.parseDate,me,[fmt],1)),result=Ext.Array.map(times,function(dt){var hours,minutes,hrIdx,mnIdx;return hours=dt.getHours(),minutes=dt.getMinutes(),hrIdx=hours>11?hours-12:hours,mnIdx=mfloor(minutes/15),[hours>11?1:0,hourValues[hrIdx],minuteValues[mnIdx]]}))}});
                Ext.define("Ext.ux.form.field.MultiValue",{isMultiValued:!0,multiValue:!1,valueSeparatorRE:/[;,]\s*/,rangeSeparatorRE:/\s*-\s*/,valuePatternRE:/\d+/,displayValueSeparator:", ",displayRangeSeparator:"-",submitValueSeparator:";",submitRangeSeparator:"-",constructor:function(config){var me=this,config=config||{};Ext.apply(me,config),me.regex=me.multiValue?me.initMultiRegex():me.initSingleRegex(),me.callParent(arguments)},initSingleRegex:function(){var me=this,value;return value=me.valueRegex(),RegExp("^"+value+"$")},initMultiRegex:function(){var me=this,value,vsep,rsep,range,valueOrRange;return value=me.valueRegex(),me.rangeSeparatorRE=RegExp(me.rangeSeparatorRE),me.valueSeparatorRE=RegExp(me.valueSeparatorRE),rsep=me.rangeSeparatorRE.source,vsep=me.valueSeparatorRE.source,range=value+rsep+value,valueOrRange="("+value+"|"+range+")",RegExp("^("+valueOrRange+")"+"("+vsep+valueOrRange+")*"+"$")},valueRegex:function(){var me=this,vp;return me.valuePatternRE=vp=RegExp(me.valuePatternRE),vp.source},formatSubmitValue:function(value){return value},formatSubmitRange:function(range,rsep){var me=this,start,end;return start=me.formatSubmitValue(range[0]),end=me.formatSubmitValue(range[1]),start+rsep+end},formatSubmit:function(values,rsep,vsep){var me=this,multi=me.multiValue,valsep=me.valueSeparatorRE,ransep=me.rangeSeparatorRE,items,isStr,doesMatch;items=me.splitValues(values,valsep);for(var i=0,l=items.length;l>i;i++){var item=items[i],vr;vr=me.splitValues(item,ransep),items[i]=vr.length>1?me.formatSubmitRange(vr,rsep||me.submitRangeSeparator):me.formatSubmitValue(vr)}return values=items.join(vsep||me.submitValueSeparator)},splitValues:function(values,regex){var me=this;return me.multiValue&&Ext.isString(values)&&""!==regex.source&&values.match(regex)?values.split(regex):[values]},formatDisplayValue:function(value){return Ext.isString(value)?value:""+value},formatDisplayRange:function(range,rsep){var me=this,start,end;return start=me.formatDisplayValue(range[0]),end=me.formatDisplayValue(range[1]),start+rsep+end},formatDisplay:function(values,rsep,vsep){var me=this,multi=me.multiValue,results=[];if(!multi)return me.formatDisplayValue(values[0]);for(var i=0,l=values.length;l>i;i++){var value=values[i];Ext.isArray(value)?results.push(me.formatDisplayRange(value,rsep||me.displayRangeSeparator)):results.push(me.formatDisplayValue(value))}return results.join(vsep||me.displayValueSeparator)}});
                Ext.define("Ext.ux.picker.MultiDate",{extend:"Ext.picker.Date",alias:"widget.multidatepicker",alternateClassName:["Ext.picker.MultiDate","Ext.MultiDatePicker"],renderTpl:['<div class="{cls}" id="{id}-innerEl" role="grid">','<div role="presentation" class="{baseCls}-header">','<div class="{baseCls}-prev"><a id="{id}-prevEl" href="#" role="button" title="{prevText}"></a></div>','<div class="{baseCls}-month" id="{id}-middleBtnEl">{%this.renderMonthBtn(values, out)%}</div>','<div class="{baseCls}-next"><a id="{id}-nextEl" href="#" role="button" title="{nextText}"></a></div>',"</div>",'<table id="{id}-eventEl" class="u{baseCls}-inner" cellspacing="0" role="presentation">','<thead role="presentation"><tr role="presentation">','<tpl for="dayNames">','<th role="columnheader" title="{.}"><span>{.:this.firstInitial}</span></th>',"</tpl>","</tr></thead>",'<tbody role="presentation"><tr role="presentation">','<tpl for="days">',"{#:this.isEndOfWeek}",'<td role="gridcell" id="{[Ext.id()]}">','<a role="presentation" href="#" hidefocus="on" class="{parent.baseCls}-date" tabIndex="1">','<em role="presentation"><span role="presentation"></span></em>',"</a>","</td>","</tpl>","</tr></tbody>","</table>",'<div id="{id}-footerEl" role="presentation" class="{baseCls}-footer">','<tpl if="this.showToday">',"{%this.renderTodayBtn(values, out)%}","<tpl else>","{%this.renderOkBtn(values, out)%}","{%this.renderCancelBtn(values, out)%}","{%this.renderClearBtn(values, out)%}","</tpl>","</div>","</div>",{firstInitial:function(value){return Ext.picker.Date.prototype.getDayInitial(value)},isEndOfWeek:function(value){value--;var end=0===value%7&&0!==value;return end?'</tr><tr role="row">':""},renderTodayBtn:function(values,out){Ext.DomHelper.generateMarkup(values.$comp.todayBtn.getRenderTree(),out)},renderOkBtn:function(values,out){Ext.DomHelper.generateMarkup(values.$comp.okBtn.getRenderTree(),out)},renderCancelBtn:function(values,out){Ext.DomHelper.generateMarkup(values.$comp.cancelBtn.getRenderTree(),out)},renderClearBtn:function(values,out){Ext.DomHelper.generateMarkup(values.$comp.clearBtn.getRenderTree(),out)},renderMonthBtn:function(values,out){Ext.DomHelper.generateMarkup(values.$comp.monthBtn.getRenderTree(),out)}}],nextText:Ext.isMac?"Next Month (&#x2318;&#x2192;)":"Next Month (Control+Right)",prevText:Ext.isMac?"Previous Month (&#x2318&#x2190;)":"Previous Month (Control+Left)",monthYearText:Ext.isMac?"Choose a month (&#x2318 + &#x2191;/&#x2193; to move years)":"Choose a month (Control+Up/Down to move years)",okText:"OK",okTooltip:Ext.isMac?"Confirm selection (⏎)":"Confirm selection (Enter)",cancelText:"Cancel",cancelTooltip:Ext.isMac?"Cancel selection (⎋)":"Cancel selection (Escape)",clearText:"Clear",clearTooltip:Ext.isMac?"Clear selection (⌘⌫)":"Clear selection (Ctrl+Backspace)",workDays:[1,2,3,4,5],showToday:!1,initComponent:function(){var me=this,wd=me.workDays;if(me.callParent(arguments),me.activeCls="ux-datepicker-active",me.selDates=[],wd&&Ext.isArray(wd)){for(var hash={0:!1,1:!1,2:!1,3:!1,4:!1,5:!1,6:!1},i=0,l=wd.length;l>i;i++)hash[wd[i]]=!0;me.workDaysHash=hash}else me.workDaysHash={0:!0,1:!0,2:!0,3:!0,4:!0,5:!0,6:!0}},beforeRender:function(){var me=this;if(me.callParent(arguments),!me.showToday){Ext.destroy(me.todayBtn);var layout=me.getComponentLayout();me.okBtn=new Ext.button.Button({ownerCt:me,ownerLayout:layout,text:me.okText,tooltip:me.okTooltip,handler:me.onOkButton,scope:me}),me.cancelBtn=new Ext.button.Button({ownerCt:me,ownerLayout:layout,text:me.cancelText,tooltip:me.cancelTooltip,handler:me.onCancelButton,scope:me}),me.clearBtn=new Ext.button.Button({ownerCt:me,ownerLayout:layout,text:me.clearText,tooltip:me.clearTooltip,handler:me.clearSelection,scope:me})}},finishRenderChildren:function(){var me=this;me.callParent(),me.showToday||(me.okBtn.finishRender(),me.cancelBtn.finishRender(),me.clearBtn.finishRender())},initEvents:function(){var me=this,evEl=me.eventEl;me.callParent(arguments),evEl.addKeyListener(Ext.EventObject.ENTER,me.onOkButton,me),evEl.addKeyListener(Ext.EventObject.ESC,me.onCancelButton,me),evEl.addKeyListener(Ext.EventObject.SPACE,me.handleSpacebar,me),evEl.addKeyListener({key:Ext.EventObject.BACKSPACE,ctrl:!0},me.clearSelection,me)},setValue:function(values){function getClearTime(d){return Ext.Date.clearTime(d).getTime()}var me=this;me.selDates=Ext.isArray(values)?Ext.Array.map(values,getClearTime):[getClearTime(values)],me.update(me.selDates)},getValue:function(){var me=this;return Ext.Array.map(me.selDates,function(t){return new Date(t)})},onOkButton:function(){var me=this,handler=me.handler;if(!me.disabled){var value=me.getValue();me.fireEvent("select",me,value),handler&&handler.call(me.scope||me,me,value),me.onSelect(),me.clearSelection()}},onCancelButton:function(){var me=this;me.clearSelection(),me.pickerField.collapse()},clearSelection:function(){var me=this,cells=me.cells,aCls=me.activeCls,sCls=me.selectedCls;me.selDates=[],me.rangeSelection=!1,cells.removeCls(aCls),cells.removeCls(sCls),me.update(Ext.Date.clearTime(new Date))},handleDateClick:function(event,target){var me=this,selDates=me.selDates,el,dv,dt;event.stopEvent(),el=Ext.fly(target.parentElement),dv=target.dateValue,event.shiftKey&&!event.ctrlKey?dt=me.toggleWeekSelection(el):event.ctrlKey?me.rangeSelection?(dt=me.selectRange(me.rangeSelection,dv,event.shiftKey),me.rangeSelection=!1):(me.rangeSelection=dv,dt=me.toggleDateSelection(el,!0,dv)):dt=me.toggleDateSelection(el,void 0,dv),dt&&me.update(selDates),me.update(new Date(dv))},handleSpacebar:function(keycode,event){var me=this,selDates=me.selDates,cells=me.cells,activeDate,activeCell,activeIdx,dt;activeDate=me.activeDate.getTime(),activeIdx=me.getCellIndex(activeDate),-1!=activeIdx&&(activeCell=cells.item(activeIdx),dt=event.shiftKey?me.toggleWeekSelection(activeCell,activeIdx):me.toggleDateSelection(activeCell,void 0,activeDate),dt&&me.update(selDates))},getCellIndex:function(value){var me=this,cells=me.cells,index;return cells.each(function(el,c,idx){index||el.down("a").getAttribute("dateValue")!==value||(index=idx)}),void 0===index?-1:index},selectRange:function(start,end,workWeek){var me=this,selDates=me.selDates,wdHash=me.workDaysHash,add=Ext.Date.add,DAY=Ext.Date.DAY,contains=Ext.Array.contains,include=Ext.Array.include,tmp,dt,dv;for(start>end&&(tmp=start,start=end,end=tmp),Ext.Array.remove(selDates,new Date(start).getTime()),dt=new Date(start),dv=dt.getTime();end>=dv;dt=add(dt,DAY,1),dv=dt.getTime())(!workWeek||wdHash[dt.getDay()])&&include(selDates,dv);return!0},toggleWeekSelection:function(el,index){var me=this,cells=me.cells,selectedCls=me.selectedCls,disabledCls=me.disabledCellCls,workDays=me.workDays,selected,dayNo,firstDay;if(void 0===index&&(index=me.getCellIndex(el.down("a").getAttribute("dateValue"))),!me.disabled&&!el.hasCls(disabledCls)&&(selected=el.hasCls(selectedCls),dayNo=index%7,firstDay=index-dayNo,Ext.Array.contains(workDays,dayNo)))for(var i=firstDay+workDays[0],l=firstDay+workDays[workDays.length-1];l>=i;i++)me.toggleDateSelection(cells.item(i),!selected);return!0},toggleDateSelection:function(el,state,dv){var me=this,selDates=me.selDates,selectedCls=me.selectedCls,disabledCls=me.disabledCellCls,selected,dv;return void 0===dv&&(dv=el.down("a").getAttribute("dateValue")),me.disabled||el.hasCls(disabledCls)||!dv?void 0:(selected=void 0!==state?!state:el.hasCls(selectedCls),selected?Ext.Array.remove(selDates,dv):Ext.Array.include(selDates,dv),el)},selectedUpdate:function(dates,active){var me=this,cells=me.cells,selectedCls=me.selectedCls,activeCls=me.activeCls,visible,cancelFocus;visible=me.isVisible(),cancelFocus=!me.focusOnSelect,cells.each(function(el){var picker=this,dv;el.removeCls([activeCls,selectedCls]),dv=el.down("a").getAttribute("dateValue"),dv===active&&(picker.getEl().set({"aria-activedescendant":el.id}),el.addCls(activeCls),visible&&!cancelFocus&&Ext.fly(el.down("a")).focus(50)),Ext.Array.contains(dates,dv)&&el.addCls(selectedCls)},me)},update:function(dates,forceRefresh){var me=this,selDates,active=me.activeDate,newActive;if(Ext.isArray(dates)&&(me.selDates=dates),selDates=me.selDates||[],newActive=Ext.isDate(dates)?dates:active,me.rendered){var am=active&&active.getMonth(),ay=active&&active.getFullYear(),nm=newActive&&newActive.getMonth(),ny=newActive&&newActive.getFullYear();me.activeDate=newActive,forceRefresh||am!=nm||ay!=ny?(me.fullUpdate(newActive,active),me.selectedUpdate(selDates,newActive.getTime())):me.selectedUpdate(selDates,newActive.getTime())}return me},beforeDestroy:function(){var me=this;me.rendered&&(Ext.destroy(me.okBtn,me.cancelBtn,me.clearBtn),delete me.selDates),me.callParent(arguments)}});
                Ext.define("Ext.ux.picker.MultiMonth",{extend:"Ext.picker.Month",alias:"widget.multimonthpicker",alternateClassName:["Ext.picker.MultiMonth","Ext.MultiMonthPicker"],childEls:["bodyEl","prevEl","nextEl","buttonsEl","monthEl","yearEl","eventEl","bodyElEnd","prevElEnd","nextElEnd"],renderTpl:['<div class="{uxCls}-table">','<div class="{uxCls}-header {uxCls}-table-row{ie}">','<div class="{uxCls}-header-item{ie}">{startingMonthText}</div>','<div class="{uxCls}-header-item{ie}">{endingMonthText}</div>',"</div>",'<div id="{id}-eventEl" class="{uxCls}-table-row{ie}">','<div id="{id}-bodyEl" class="{baseCls}-body {uxCls}-table-cell{ie}">','<div class="{baseCls}-months">','<tpl for="months">','<div class="{parent.baseCls}-item {parent.baseCls}-month"><a href="#" hidefocus="on">{.}</a></div>',"</tpl>","</div>",'<div class="{baseCls}-years">','<div class="{baseCls}-yearnav">','<button id="{id}-prevEl" class="{baseCls}-yearnav-prev"></button>','<button id="{id}-nextEl" class="{baseCls}-yearnav-next"></button>',"</div>",'<tpl for="years">','<div class="{parent.baseCls}-item {parent.baseCls}-year"><a href="#" hidefocus="on">{.}</a></div>',"</tpl>","</div>",'<div class="'+Ext.baseCSSPrefix+'clear"></div>',"</div>",'<div id="{id}-bodyElEnd" class="{baseCls}-body {uxCls}-table-cell{ie} {uxCls}-separator">','<div class="{baseCls}-months">','<tpl for="months">','<div class="{parent.baseCls}-item {parent.baseCls}-month"><a href="#" hidefocus="on">{.}</a></div>',"</tpl>","</div>",'<div class="{baseCls}-years">','<div class="{baseCls}-yearnav">','<button id="{id}-prevElEnd" class="{baseCls}-yearnav-prev"></button>','<button id="{id}-nextElEnd" class="{baseCls}-yearnav-next"></button>',"</div>",'<tpl for="years">','<div class="{parent.baseCls}-item {parent.baseCls}-year"><a href="#" hidefocus="on">{.}</a></div>',"</tpl>","</div>",'<div class="'+Ext.baseCSSPrefix+'clear"></div>',"</div>","</div>","</div>",'<tpl if="showButtons">','<div id="{id}-buttonsEl" class="{baseCls}-buttons">{%',"var me        = values.$comp,","okBtn     = me.okBtn,","cancelBtn = me.cancelBtn,","clearBtn  = me.clearBtn;","okBtn.ownerLayout = cancelBtn.ownerLayout = clearBtn.ownerLayout = me.componentLayout;","okBtn.ownerCt     = cancelBtn.ownerCt     = clearBtn.ownerCt     = me;","Ext.DomHelper.generateMarkup(okBtn.getRenderTree(), out);","Ext.DomHelper.generateMarkup(cancelBtn.getRenderTree(), out);","Ext.DomHelper.generateMarkup(clearBtn.getRenderTree(), out);","%}</div>","</tpl>"],startingMonthText:"Starting Month",endingMonthText:"Ending Month",clearText:"Clear",uxCls:"ux-monthpicker",width:356,initComponent:function(){var me=this;me.activeYearEnd=me.getYearEnd((new Date).getFullYear()-4,-4),me.callParent(),me.showButtons&&(me.clearBtn=new Ext.button.Button({text:me.clearText,handler:me.onClearClick,scope:me}))},initEvents:function(){var me=this,evEl=me.eventEl;me.callParent(),evEl.addKeyListener(Ext.EventObject.ENTER,me.onOkClick,me),evEl.addKeyListener(Ext.EventObject.ESC,me.onCancelClick,me)},beforeRender:function(){var me=this,body;Ext.applyIf(me,{renderData:{}}),Ext.apply(me.renderData,{uxCls:me.uxCls,startingMonthText:me.startingMonthText,endingMonthText:me.endingMonthText,ie:Ext.isIE6||Ext.isIE7?"-ie":""}),me.callParent(arguments)},finishRenderChildren:function(){var me=this;me.callParent(),me.showButtons&&me.clearBtn.finishRender()},afterRender:function(){var me=this,body=me.bodyElEnd,buttonsEl=me.buttonsEl;me.mon(body,"click",me.onBodyClick,me),me.mon(body,"dblclick",me.onBodyClick,me),me.yearsEnd=body.select("."+me.baseCls+"-year a"),me.monthsEnd=body.select("."+me.baseCls+"-month a"),me.backRepeaterEnd=Ext.create("Ext.util.ClickRepeater",me.prevElEnd,{handler:Ext.Function.bind(me.adjustYearEnd,me,[-me.totalYears])}),me.prevElEnd.addClsOnOver(me.baseCls+"-yearnav-prev-over"),me.nextRepeaterEnd=Ext.create("Ext.util.ClickRepeater",me.nextElEnd,{handler:Ext.Function.bind(me.adjustYearEnd,me,[me.totalYears])}),me.nextElEnd.addClsOnOver(me.baseCls+"-yearnav-next-over"),me.callParent()},clearValues:function(){var me=this,now;return now=Ext.Date.clearTime(new Date),me.value=[[now.getMonth(),now.getFullYear()],[now.getMonth(),now.getFullYear()]],me.activeYear=me.activeYearEnd=me.getYear(now.getFullYear()-4,-4),me.updateBody(),me.value},setValue:function(values){var me=this,year,active;me.value=values||me.clearValues(),year=me.getYear(null),active=me.activeYear,null!==year&&(active>year||year>active+me.yearOffset)&&(me.activeYear=year-me.yearOffset+1),year=me.getYearEnd(null),active=me.activeYearEnd,null!==year&&(active>year||year>active+me.yearOffset)&&(me.activeYearEnd=year-me.yearOffset+1),me.updateBody()},getYearsEnd:function(){for(var me=this,offset=me.yearOffset,start=me.activeYearEnd,end=start+offset,i=start,years=[];end>i;++i)years.push(i,i+offset);return years},updateBody:function(){var me=this;me.rendered&&(me._updateBody({years:me.years,months:me.months,cls:me.selectedCls,yearNumbers:me.getYears(),value:me.getYear(null),month:me.getMonth("start")}),me._updateBody({years:me.yearsEnd,months:me.monthsEnd,cls:me.selectedCls,yearNumbers:me.getYearsEnd(),value:me.getYearEnd(null),month:me.getMonth("end")}))},_updateBody:function(p){var me=this,years=p.years,months=p.months,cls=p.cls,yearNumbers=p.yearNumbers,monthOffset=me.monthOffset,value=p.value,month=p.month;years.removeCls(cls),months.removeCls(cls),years.each(function(el,all,index){var year=yearNumbers[index];el.dom.innerHTML=year,year==value&&(el.dom.className=cls,el.focus(50))}),null!==month&&(month=monthOffset>month?2*month:2*(month-monthOffset)+1,months.item(month).addCls(cls))},getMonth:function(which){var me=this,month;try{month="start"==which?me.value[0][0]:me.value[1][0]}catch(e){month=null}return month},setMonth:function(which,value){var me=this;"start"==which?me.value[0][0]=value:me.value[1][0]=value},getYear:function(defaultValue,offset){var me=this,year;try{year=me.value[0][1]}catch(e){year=null}return offset=offset||0,null===year?defaultValue:year+offset},getYearEnd:function(defaultValue,offset){var me=this,year;try{year=me.value[1][1]}catch(e){year=null}return offset=offset||0,null===year?defaultValue:year+offset},setYear:function(which,value){var me=this;"start"==which?me.value[0][1]=value:me.value[1][1]=value},adjustYearEnd:function(offset){var me=this;"number"!=Ext.typeOf(offset)&&(offset=me.totalYears),me.activeYearEnd+=offset,me.updateBody()},onMonthClick:function(target){var me=this,idx,value,which="start";idx=me.months.indexOf(target),-1===idx&&(idx=me.monthsEnd.indexOf(target),which="end"),value=me.resolveOffset(idx,me.monthOffset),me.setMonth(which,value),me.updateBody(),me.fireEvent("monthclick",me,me.value),me.fireEvent("select",me,me.value)},onYearClick:function(target){var me=this,idx,value,which="start";idx=me.years.indexOf(target),-1===idx&&(idx=me.yearsEnd.indexOf(target),which="end"),value=("start"==which?me.activeYear:me.activeYearEnd)+me.resolveOffset(idx,me.yearOffset),me.setYear(which,value),me.updateBody(),me.fireEvent("yearclick",me,me.value),me.fireEvent("select",me,me.value)},onOkClick:function(){this.callParent(),this.clearValues()},onCancelClick:function(){this.callParent(),this.clearValues()},onClearClick:function(){this.clearValues()},beforeDestroy:function(){var me=this;me.rendered&&Ext.destroy(me.clearBtn),me.yearsEnd=me.monthsEnd=null,Ext.destroyMembers("backRepeaterEnd","nextRepeaterEnd","eventEl","prevElEnd","nextElEnd","clearBtn"),me.callParent()}});
                Ext.define("Ext.ux.picker.MultiTime",{extend:"Ext.Component",alias:"widget.multitimepicker",alternateClassName:["Ext.picker.MultiTime","Ext.MultiTimePicker"],requires:["Ext.XTemplate","Ext.Date","Ext.button.Button"],childEls:["bodyEl","eventEl","bodyElStart","bodyElEnd","buttonsEl"],renderTpl:['<div id="{id}-bodyEl" class="{baseCls}-table">','<div class="{baseCls}-header {baseCls}-table-row{ie}">','<tpl if="multiValue">','<div class="{baseCls}-header-item{ie}">{startingTimeText}</div>','<div class="{baseCls}-header-item{ie}">{endingTimeText}</div>',"<tpl else>",'<div class="{baseCls}-header-item{ie}">{selectTimeText}</div>',"</tpl>","</div>",'<div id="{id}-eventEl" class="{baseCls}-table-row{ie}">','<div id="{id}-bodyElStart" class="{baseCls}-body {baseCls}-table-cell{ie}">','<div class="{baseCls}-table-row{ie}">','<div class="{baseCls}-item {baseCls}-ampm"><a href="#" hidefocus="on">{amText}</a></div>','<div class="{baseCls}-item {baseCls}-ampm"><a href="#" hidefocus="on">{pmText}</a></div>',"</div>",'<div class="{baseCls}-separator">','<div class="{baseCls}-separator-stricken {baseCls}-separator-left">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>','<div class="{baseCls}-separator-text">{hoursText}</div>','<div class="{baseCls}-separator-stricken {baseCls}-separator-right">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>',"</div>",'<div class="{baseCls}-table-row{ie}">','<tpl for="hours">','<div class="{parent.baseCls}-item {parent.baseCls}-hour"><a href="#" hidefocus="on">{.}</a></div>',"</tpl>","</div>",'<div class="{baseCls}-separator">','<div class="{baseCls}-separator-stricken {baseCls}-separator-left">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>','<div class="{baseCls}-separator-text">{minutesText}</div>','<div class="{baseCls}-separator-stricken {baseCls}-separator-right">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>',"</div>",'<div class="{baseCls}-table-row{ie} {baseCls}-minutes">','<tpl for="minutes">','<div class="{parent.baseCls}-item {parent.baseCls}-minute"><a href="#" hidefocus="on">{.}</a></div>',"</tpl>","</div>","</div>",'<tpl if="multiValue">','<div id="{id}-bodyElEnd" class="{baseCls}-body {baseCls}-table-cell{ie} {baseCls}-inner-border">','<div class="{baseCls}-table-row{ie}">','<div class="{baseCls}-item {baseCls}-ampm"><a href="#" hidefocus="on">{amText}</a></div>','<div class="{baseCls}-item {baseCls}-ampm"><a href="#" hidefocus="on">{pmText}</a></div>',"</div>",'<div class="{baseCls}-separator">','<div class="{baseCls}-separator-stricken {baseCls}-separator-left">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>','<div class="{baseCls}-separator-text">{hoursText}</div>','<div class="{baseCls}-separator-stricken {baseCls}-separator-right">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>',"</div>",'<div class="{baseCls}-table-row{ie}">','<tpl for="hours">','<div class="{parent.baseCls}-item {parent.baseCls}-hour"><a href="#" hidefocus="on">{.}</a></div>',"</tpl>","</div>",'<div class="{baseCls}-separator">','<div class="{baseCls}-separator-stricken {baseCls}-separator-left">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>','<div class="{baseCls}-separator-text">{minutesText}</div>','<div class="{baseCls}-separator-stricken {baseCls}-separator-right">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>',"</div>",'<div class="{baseCls}-table-row{ie} {baseCls}-minutes">','<tpl for="minutes">','<div class="{parent.baseCls}-item {parent.baseCls}-minute"><a href="#" hidefocus="on">{.}</a></div>',"</tpl>","</div>","</div>","</tpl>","</div>","</div>",'<div id="{id}-buttonsEl" class="{baseCls}-buttons">{%',"var me        = values.$comp,","okBtn     = me.okBtn,","cancelBtn = me.cancelBtn,","clearBtn  = me.clearBtn;","okBtn.ownerLayout = cancelBtn.ownerLayout = clearBtn.ownerLayout = me.componentLayout;","okBtn.ownerCt     = cancelBtn.ownerCt     = clearBtn.ownerCt     = me;","Ext.DomHelper.generateMarkup(okBtn.getRenderTree(), out);","Ext.DomHelper.generateMarkup(cancelBtn.getRenderTree(), out);","Ext.DomHelper.generateMarkup(clearBtn.getRenderTree(), out);","%}</div>"],selectTimeText:"Select Time",startingTimeText:"Starting Time",endingTimeText:"Ending Time",amText:"AM",pmText:"PM",hoursText:"Hours:",minutesText:"Minutes:",okText:"OK",cancelText:"Cancel",clearText:"Clear",hourValues:["12","1","2","3","4","5","6","7","8","9","10","11"],minuteValues:["00","15","30","45"],baseCls:"ux-timepicker",width:179,initComponent:function(){var me=this;me.multiValue&&(me.width*=2),me.selectedCls=me.baseCls+"-selected",me.disabledCls=me.baseCls+"-disabled",me.addEvents("okclick","cancelclick","clearclick","ampmclick","hourclick","minuteclick"),me.callParent(),me.initButtons(),me.initDisabledValues(),me.setInitialValue()},show:function(){var me=this;me.callParent(),me.seenEnter=!1,me.seenEscape=!1,me.updateBody()},initDisabledValues:function(){var me=this,disabledMinutes;switch(me.increment){case 60:disabledMinutes=[1,2,3];break;case 30:disabledMinutes=[1,3];break;default:disabledMinutes=[]}me.disabledMinutes=disabledMinutes},setInitialValue:function(){var me=this;me.setValue(me.value||me.clearValue()),me.updateBody()},beforeRender:function(){var me=this;me.callParent(arguments),Ext.apply(me.renderData,{selectTimeText:me.selectTimeText,startingTimeText:me.startingTimeText,endingTimeText:me.endingTimeText,amText:me.amText,pmText:me.pmText,hoursText:me.hoursText,minutesText:me.minutesText,hours:me.hourValues,minutes:me.minuteValues,baseCls:me.baseCls,multiValue:me.multiValue,ie:Ext.isIE6||Ext.isIE7?"-ie":""})},afterRender:function(){var me=this;me.callParent(),me.initEvents(),me.initCollections()},finishRenderChildren:function(){var me=this;me.callParent(),me.okBtn.finishRender(),me.cancelBtn.finishRender(),me.clearBtn.finishRender()},initEvents:function(){var me=this,bodyStart=me.bodyElStart,bodyEnd=me.bodyElEnd,evEl=me.eventEl;me.mon(bodyStart,"click",me.onBodyStartClick,me),me.mon(bodyStart,"dblclick",me.onBodyStartClick,me),bodyEnd&&(me.mon(bodyEnd,"click",me.onBodyEndClick,me),me.mon(bodyEnd,"dblclick",me.onBodyEndClick,me)),evEl.addKeyListener(Ext.EventObject.ENTER,me.onEnter,me),evEl.addKeyListener(Ext.EventObject.ESC,me.onEscape,me)},initCollections:function(){var me=this,bodyStart=me.bodyElStart,bodyEnd=me.bodyElEnd;me.ampmStart=bodyStart.select("."+me.baseCls+"-ampm a"),me.hoursStart=bodyStart.select("."+me.baseCls+"-hour a"),me.minutesStart=bodyStart.select("."+me.baseCls+"-minute a"),bodyEnd&&(me.ampmEnd=bodyEnd.select("."+me.baseCls+"-ampm a"),me.hoursEnd=bodyEnd.select("."+me.baseCls+"-hour a"),me.minutesEnd=bodyEnd.select("."+me.baseCls+"-minute a"))},initButtons:function(){var me=this;me.okBtn=me.initOkButton(),me.cancelBtn=me.initCancelButton(),me.clearBtn=me.initClearButton()},initOkButton:function(){var me=this;return new Ext.button.Button({text:me.okText,handler:me.onOkClick,scope:me})},initCancelButton:function(){var me=this;return new Ext.button.Button({text:me.cancelText,handler:me.onCancelClick,scope:me})},initClearButton:function(){var me=this;return new Ext.button.Button({text:me.clearText,handler:me.onClearClick,scope:me})},onBodyStartClick:function(e,t){this.onBodyClick(e,t,"start")},onBodyEndClick:function(e,t){this.onBodyClick(e,t,"end")},onBodyClick:function(e,t,which){var me=this,disabledCls=me.disabledCls;new Ext.Element(t).hasCls(disabledCls)||(e.getTarget("."+me.baseCls+"-ampm")?(e.stopEvent(),me.onAmPmClick(t,which)):e.getTarget("."+me.baseCls+"-hour")?(e.stopEvent(),me.onHourClick(t,which)):e.getTarget("."+me.baseCls+"-minute")&&(e.stopEvent(),me.onMinuteClick(t,which)))},onAmPmClick:function(t,which){var me=this,value=me.value,ampm,idx;ampm="start"==which?me.ampmStart:me.ampmEnd,idx=ampm.indexOf(t),me.setAmPm(which,idx),me.fireEvent("ampmclick",me,me.value),me.updateBody()},onHourClick:function(t,which){var me=this,value=me.value,hourValues=me.hourValues,hours,idx;hours="start"==which?me.hoursStart:me.hoursEnd,idx=hours.indexOf(t),me.setHours(which,hourValues[idx]),me.fireEvent("hourclick",me,me.value),me.updateBody()},onMinuteClick:function(t,which){var me=this,value=me.value,minuteValues=me.minuteValues,minutes,idx;minutes="start"==which?me.minutesStart:me.minutesEnd,idx=minutes.indexOf(t),me.setMinutes(which,minuteValues[idx]),me.fireEvent("minuteclick",me,me.value),me.updateBody()},clearValue:function(){var me=this;return me.value=[[null,null,null],[null,null,null]],me.value},getValue:function(values){var me=this;return me.multiValue?me.value:me.getStartValue()},setValue:function(values){var me=this;me.value=me.multiValue?values:Ext.isArray(values)?[values[0],[null,null,null]]:me.clearValue(),me.updateBody()},updateBody:function(){var me=this;me.rendered&&(me.updateBodySections({ampm:me.ampmStart,hours:me.hoursStart,minutes:me.minutesStart,value:me.getStartValue(),which:"start"}),me.multiValue&&me.updateBodySections({ampm:me.ampmEnd,hours:me.hoursEnd,minutes:me.minutesEnd,value:me.getEndValue(),which:"end"}))},updateBodySections:function(p){var me=this,ampm=p.ampm,hours=p.hours,minutes=p.minutes,value=p.value,which=p.which;me.updateAmPmSelection(ampm,value,which),me.updateHourSelection(hours,value,which),me.updateMinuteSelection(minutes,value,which)},updateAmPmSelection:function(section,value){var me=this,selectedCls=me.selectedCls,ampm=value[0],item;section.removeCls(selectedCls),item=section.item(ampm),item&&item.addCls(selectedCls)},updateHourSelection:function(section,value){var me=this,selectedCls=me.selectedCls,disabledCls=me.disabledCls,hourValues=me.hourValues,increment=me.increment,mfloor=Math.floor,ampm=value[0],hours=value[1],minutes=value[2],minTime,maxTime,offset;offset=12*ampm,minTime=3600*mfloor(me.minTime/3600),maxTime=3600*mfloor(me.maxTime/3600),section.removeCls(selectedCls),section.removeCls(disabledCls),section.each(function(el,all,index){var hourValue=hourValues[index],seconds,disabled;seconds=3600*(offset+index),disabled=null===ampm?!1:minTime>seconds||seconds>maxTime,disabled?el.dom.className=disabledCls:hourValue===hours&&(el.dom.className=selectedCls,el.focus(50))})},updateMinuteSelection:function(section,value,which){var me=this,selectedCls=me.selectedCls,disabledCls=me.disabledCls,hourValues=me.hourValues,minuteValues=me.minuteValues,disabledMin=me.disabledMinutes,increment=me.increment,minTime=me.minTime,maxTime=me.maxTime,contains=Ext.Array.contains,indexOf=Ext.Array.indexOf,ampm=value[0],minutes=value[2],hours,offset;offset=12*ampm,hours=null!==value[1]?indexOf(hourValues,value[1]):0/0,section.removeCls(selectedCls),section.removeCls(disabledCls),section.each(function(el,all,index){var minuteValue=minuteValues[index],seconds,disabled;seconds=3600*(offset+hours)+60*15*index,disabled=contains(disabledMin,index)?!0:null===ampm?!1:"start"==which?minTime>seconds:"end"==which?seconds>maxTime:!1,disabled?el.dom.className=disabledCls:minutes===minuteValue&&(el.dom.className=selectedCls,el.focus(50))})},getStartValue:function(){var me=this,value=me.value;return value[0]},getEndValue:function(){var me=this,value=me.value;return value[1]},setAmPm:function(which,value){this.value["start"==which?0:1][0]=value},setHours:function(which,value){this.value["start"==which?0:1][1]=value},setMinutes:function(which,value){this.value["start"==which?0:1][2]=value},onEnter:function(key,e){var me=this;e.stopEvent(),me.seenEnter?me.seenEnter=!1:(me.onOkClick(),me.seenEnter=!0)},onEscape:function(key,e){var me=this;e.stopEvent(),me.seenEscape?me.seenEscape=!1:(me.onCancelClick(),me.seenEscape=!0)},onOkClick:function(){var me=this;me.fireEvent("okclick",me,me.value),me.clearValue(),me.updateBody()},onCancelClick:function(){var me=this;me.fireEvent("cancelclick",me),me.clearValue(),me.updateBody()},onClearClick:function(){var me=this;me.fireEvent("clearclick",me),me.clearValue(),me.updateBody()},beforeDestroy:function(){var me=this;me.rendered&&Ext.destroy(me.okBtn,me.cancelBtn,me.clearBtn),Ext.destroyMembers("bodyEl","bodyElStart","bodyElEnd","eventEl","buttonsEl"),me.callParent()}});

            Rally.launchApp('CustomApp', {
                name:"exclusions",
	            parentRepos:""
            });

        });
    </script>


    <style type="text/css">
        
    </style>
    <style type="text/css">
        .ux-datepicker-active{cursor:pointer;color:#000;background:repeat-x left top;background-color:#ddecfe}.ux-datepicker-inner,.ux-datepicker-inner td,.ux-datepicker-inner th{border-collapse:separate}table.ux-datepicker-inner{width:100%;table-layout:fixed}table.ux-datepicker-inner th{width:25px;height:19px;color:#233d6d;font:normal 10px tahoma,arial,verdana,sans-serif;text-align:right;border-bottom:1px solid #b2d1f5;border-collapse:separate;background-color:#dfecfb;background-image:linear-gradient(top, #edf4fd, #cde1f9);cursor:default;padding:0}table.ux-datepicker-inner th span{display:block;padding-right:7px}table.ux-datepicker-inner td{border:1px solid;height:17px;text-align:right;border-color:#FFF;padding:0}table.ux-datepicker-inner a{padding-right:4px;display:block;zoom:1;font:normal 11px tahoma,arial,verdana,sans-serif;color:#000;text-decoration:none;text-align:right}table.ux-datepicker-inner .ux-datepicker-active{cursor:pointer;color:#000;border:1px solid;border-color:#ff0000}table.ux-datepicker-inner .x-datepicker-selected a{background:repeat-x left top;background-color:#dae5f3;border:1px solid #8db2e3}table.ux-datepicker-inner .x-datepicker-selected span{font-weight:700}table.ux-datepicker-inner .x-datepicker-today a{border:1px solid;border-color:#8B0000}table.ux-datepicker-inner .x-datepicker-prevday a,table.ux-datepicker-inner .x-datepicker-nextday a{text-decoration:none!important;color:#aaa}table.ux-datepicker-inner a:hover,table.ux-datepicker-inner .x-datepicker-disabled a:hover{text-decoration:none!important}table.ux-datepicker-inner .u-datepicker-disabled a{cursor:default;background-color:#eee;color:#bbb}.x-item-disabled .ux-datepicker-inner a:hover{background:none}
    </style>
</head>
<body>
</body>
</html>
